<div class="reset-container">
  <mat-card class="reset-card">

    <!-- Loading Bar -->
    <mat-progress-bar mode="indeterminate" *ngIf="loading"></mat-progress-bar>

    <div class="card-header">
      <mat-icon>lock_reset</mat-icon>
      <h2>Reset Password</h2>
      <p>Please enter your new password below.</p>
    </div>

    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">

        <!-- New Password Field -->
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>New Password</mat-label>
          <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password">
          <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePassword">
            <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="form.get('password')?.hasError('required')">
            Password is required
          </mat-error>
          <mat-error *ngIf="form.get('password')?.hasError('minlength')">
            Must be at least 6 characters
          </mat-error>
        </mat-form-field>

        <!-- Confirm Password Field -->
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Confirm Password</mat-label>
          <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword">
          <button mat-icon-button matSuffix type="button" (click)="hideConfirmPassword = !hideConfirmPassword" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideConfirmPassword">
            <mat-icon>{{hideConfirmPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="form.get('confirmPassword')?.hasError('required')">
            Confirmation is required
          </mat-error>
          <mat-error *ngIf="form.hasError('notSame') && !form.get('confirmPassword')?.hasError('required')">
            Passwords do not match
          </mat-error>
        </mat-form-field>

        <div class="action-buttons">
          <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid || loading" class="py-1">
            {{ loading ? 'Updating...' : 'Set New Password' }}
          </button>

          <button mat-button type="button" routerLink="/login" [disabled]="loading">
            Back to Login
          </button>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>
