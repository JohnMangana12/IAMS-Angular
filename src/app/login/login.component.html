<div class="container d-flex align-items-center justify-content-center vh-100">
  <div class="card w-100" style="max-width: 400px;">
    <div class="card-body text-center p-4">
      <!-- Logo -->
      <img src="assets/emerson3.png" alt="Emerson logo" class="img-fluid mb-3" style="max-width: 150px;">

      <!-- Title -->
      <h1 class="fs-2 fw-bold mb-4 text-primary">INFRA ASSET MANAGEMENT SYSTEM</h1>

      <!-- Login Form -->
      <form [formGroup]="form" (ngSubmit)="login()">
        <!-- Username Input -->
        <div class="input-group mb-3">
          <span class="input-group-text bg-light border-end-0">
            <i class="bi bi-person-fill fs-3 text-primary"></i>
          </span>
          <input
            id="username"
            type="text"
            class="form-control border-start-0 ps-0"
            formControlName="username"
            placeholder="Username"
            [ngbTypeahead]="search"
            aria-label="Username"
          />
        </div>
        <!-- Password Input -->
        <div class="input-group mb-3">
          <span class="input-group-text bg-light border-end-0">
            <i class="bi bi-lock-fill fs-3 text-primary"></i>
          </span>
          <input
            id="password"
            type="password"
            class="form-control border-start-0 ps-0"
            formControlName="password"
            placeholder="Password"
            aria-label="Password"
          />
        </div>

        <!-- NEW: Forgot Password Link -->
        <div class="d-flex justify-content-end mb-3">
          <a
            href="javascript:void(0)"
            class="text-decoration-none small"
            (click)="openResetModal(resetModal)">
            Forgot Password?
          </a>
        </div>

        <!-- Login Button -->
        <div class="d-grid">
          <button
            type="submit"
            class="btn btn-primary btn-lg"
            [disabled]="!form.valid"
          >
            Login
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- NEW: Reset Password Modal Template -->
<ng-template #resetModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Reset Password</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <!-- UPDATED TEXT: Inform the user about the email link -->
    <p>Enter your username. We will send a password reset link to your registered email address.</p>

    <div class="mb-3">
      <label for="resetUsername" class="form-label">Username</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-person"></i></span>
        <input
          type="text"
          class="form-control"
          id="resetUsername"
          [(ngModel)]="resetUsernameStr"
          placeholder="Enter username"
          (keydown.enter)="confirmReset(modal)">
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.dismiss('cancel')">Cancel</button>
    <!-- UPDATED LABEL: Changed from "Reset Password" to "Send Reset Link" -->
    <button type="button" class="btn btn-primary" (click)="confirmReset(modal)">Send Reset Link</button>
  </div>
</ng-template>
