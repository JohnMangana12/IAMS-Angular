<!-- src/app/change-password/change-password.component.html -->

<div class="container d-flex align-items-center justify-content-center vh-100">
  <div class="card w-100" style="max-width: 450px;">
    <div class="card-body text-center p-4">
      <h1 class="fs-4 fw-bold mb-3 text-danger">PASSWORD CHANGE REQUIRED</h1>
      <p class="text-muted">
        Your account requires a password update. Please enter your current one-time password (OTP) and a new permanent password.
      </p>

      <form [formGroup]="changePasswordForm" (ngSubmit)="changePassword()">

        <!-- Current Password (OTP) Input -->
        <div class="input-group mb-3">
          <span class="input-group-text bg-light border-end-0">
            <i class="bi bi-lock-fill fs-3 text-warning"></i>
          </span>
          <input
            type="password"
            class="form-control border-start-0 ps-0"
            formControlName="currentPassword"
            placeholder="Current Password (OTP)"
          />
        </div>
        <div *ngIf="changePasswordForm.get('currentPassword')?.invalid && changePasswordForm.get('currentPassword')?.touched" class="text-danger text-start mb-2 small">
          Current password is required.
        </div>

        <!-- New Password Input -->
        <div class="input-group mb-3">
          <span class="input-group-text bg-light border-end-0">
            <i class="bi bi-key-fill fs-3 text-primary"></i>
          </span>
          <input
            type="password"
            class="form-control border-start-0 ps-0"
            formControlName="newPassword"
            placeholder="New Password (min 8 chars)"
          />
        </div>
        <div *ngIf="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched" class="text-danger text-start mb-2 small">
          <span *ngIf="changePasswordForm.get('newPassword')?.errors?.['required']">New password is required.</span>
          <span *ngIf="changePasswordForm.get('newPassword')?.errors?.['minlength']">New password must be at least 8 characters.</span>
        </div>

        <!-- Confirm New Password Input -->
        <div class="input-group mb-3">
          <span class="input-group-text bg-light border-end-0">
            <i class="bi bi-check-lg fs-3 text-primary"></i>
          </span>
          <input
            type="password"
            class="form-control border-start-0 ps-0"
            formControlName="confirmPassword"
            placeholder="Confirm New Password"
          />
        </div>
        <div *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['mismatch'] && changePasswordForm.get('confirmPassword')?.touched" class="text-danger text-start mb-2 small">
          Passwords do not match.
        </div>

        <!-- Submit Button -->
        <div class="d-grid">
          <button
            type="submit"
            class="btn btn-primary btn-lg mt-3"
            [disabled]="changePasswordForm.invalid || changePasswordForm.disabled"
          >
            Set New Password
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
